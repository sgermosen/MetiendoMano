(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{233:function(e,t,n){"use strict";function o(e,t){var n=t.target.dataset.targetType,o="personal"===n?"moderator":"personal";t.target.classList.toggle("active"),e.querySelector(".".concat(o,"-template-button")).classList.toggle("active"),e.querySelector(".".concat(n,"-responses-container")).classList.toggle("hidden"),e.querySelector(".".concat(o,"-responses-container")).classList.toggle("hidden")}n.r(t);function a(e){var t=e.querySelector(".response-templates-container"),n="new_comment"!==e.id?e.querySelector("input#comment_parent_id").value:null,o=Array.from(t.getElementsByClassName("insert-template-button")),a=Array.from(t.getElementsByClassName("moderator-submit-button"));o.forEach((function(n){n.addEventListener("click",(function(n){var o=n.target.dataset.content,a=e.querySelector("textarea");(null===a.value||""===a.value||confirm("Are you sure you want to replace your current comment draft?"))&&(a.value=o,t.classList.toggle("hidden"))}))})),a.forEach((function(e){e.addEventListener("click",(function(e){var t,o,a;e.preventDefault(),confirm("\nAre you sure you want to submit this comment as Sloan?\n\nIt will be sent immediately and users will be notified.\n\nMake sure this is the appropriate comment for the situation.\n\nThis action is not reversible.")&&(t=e.target.dataset.responseTemplateId,o=n,a=document.querySelector("input#comment_commentable_id").value,fetch("/comments/moderator_create",{method:"POST",headers:{Accept:"application/json","X-CSRF-Token":window.csrfToken,"Content-Type":"application/json"},body:JSON.stringify({response_template:{id:t},comment:{body_markdown:"",commentable_id:a,commentable_type:"Article",parent_id:o}})}).then((function(e){return e.json()})).then((function(e){"created"===e.status?window.location.pathname=e.path:"comment already exists"===e.status?alert("This comment already exists."):"error"===e.error&&alert("There was a problem submitting this comment: ".concat(e.status))})))}))}))}function r(e,t){var n,o=document.getElementById(t);"personal_comment"===e?n=o.querySelector(".personal-responses-container"):"mod_comment"===e&&(n=o.querySelector(".moderator-responses-container")),fetch("/response_templates?type_of=".concat(e),{method:"GET",headers:{Accept:"application/json","X-CSRF-Token":window.csrfToken,"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){o.querySelector("img.loading-img").classList.toggle("hidden"),n.innerHTML=function(e,t){return 0===e.length&&"personal_comment"===t?'\n<div class="mod-response-wrapper mod-response-wrapper-empty">\n  <p>\ud83e\udd14... It looks like you don\'t have any templates yet.</p>\n</div>\n':"personal_comment"===t?e.map((function(e){return'\n          <div class="mod-response-wrapper">\n            <span>'.concat(e.title,"</span>\n            <p>").concat(e.content,'</p>\n            <button class="insert-template-button" type="button" data-content="').concat(e.content,'">INSERT</button>\n          </div>\n        ')})).join(""):"mod_comment"===t?e.map((function(e){return'\n            <div class="mod-response-wrapper">\n              <span>'.concat(e.title,"</span>\n              <p>").concat(e.content,'</p>\n              <button class="insert-template-button" type="button" data-content="').concat(e.content,'">INSERT</button>\n              <button class="moderator-submit-button" type="submit" data-response-template-id="').concat(e.id,'">SEND AS MOD</button>\n            </div>\n          ')})).join(""):"Error \ud83d\ude1e"}(t,e),document.getElementById("response-templates-data").innerHTML=n.parentElement.innerHTML,a(o)}))}function s(e){var t=e.querySelector(".response-templates-container"),n=""!==document.getElementById("response-templates-data").innerHTML;t.classList.toggle("hidden");var s=t.classList.contains("hidden");n&&!s?(!function(e){e.innerHTML=document.getElementById("response-templates-data").innerHTML}(t),a(e)):n||s||function(e){e.querySelector("img.loading-img").classList.toggle("hidden"),r("personal_comment",e.id)}(e),userData().moderator_for_tags.length>0?function(e){var t=e.querySelector(".personal-template-button"),n=e.querySelector(".moderator-template-button");t.addEventListener("click",(function(t){o(e,t)})),n.addEventListener("click",(function(t){o(e,t)})),n.classList.remove("hidden"),n.addEventListener("click",(function(){var t=document.getElementById("response-templates-data");""!==t.innerHTML&&0===t.querySelector(".moderator-responses-container").childElementCount&&(e.querySelector("img.loading-img").classList.toggle("hidden"),r("mod_comment",e.id))}),{once:!0})}(e):e.querySelector(".personal-template-button").classList.add("hidden")}function c(e){var t=e.querySelector(".response-templates-button");t&&(t.addEventListener("click",(function(){s(e)})),t.dataset.hasListener="true")}function i(){var e,t,n=document.body.dataset.userStatus,o=document.getElementById("new_comment");document.getElementById("response-templates-data")&&("logged-out"===n&&document.querySelector(".response-templates-button").addEventListener("click",showModal),o&&"false"===o.querySelector(".response-templates-button").dataset.hasListener&&c(o),e=new MutationObserver((function(e){var t=e[0].addedNodes[0];"FORM"===t.nodeName&&c(t)})),t=document.getElementById("comment-trees-container"),e.observe(t,{childList:!0,subtree:!0}),window.addEventListener("beforeunload",(function(){e.disconnect()})),window.InstantClick.on("change",(function(){e.disconnect()})))}window.InstantClick.on("change",(function(){i()})),i()}},[[233,55]]]);
//# sourceMappingURL=responseTemplates-24b018bc01bbc223e4c1.chunk.js.map